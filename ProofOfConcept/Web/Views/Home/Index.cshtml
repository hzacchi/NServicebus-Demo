@{
    ViewBag.Title = "Index";
}

<style>
    .section {height:250px} 
    .clear {clear:both}
    
    #packout { float: left;width: 48%}
    #scrap { float: right;width: 48%}

    ul {list-style-type: none}
    ul li { float: left;width: 30%;height: 25px;background-color: green;margin: 0px 2px 2px 0px;color: white;text-align: center;padding: 2px 0px 0px 2px}
</style>

<fieldset id="wip" class="section">
    <legend>Wip Release</legend>
    <section>
        Next Wip Released In: <span id="timer"></span> seconds
    </section>
    <ul></ul>
    <div class="clear"></div>
</fieldset>


<fieldset id="assemble" class="section">
    <legend>Assemble</legend>
    <ul></ul>
    <div class="clear"></div>
    <input type="button" id="move" value="Move"/>
</fieldset>


<fieldset id="packout" class="section">
    <legend>Packout</legend>
    <ul></ul>
    <div class="clear"></div>
</fieldset>


<fieldset id="scrap" class="section">
    <legend>Scrap</legend>
    <ul></ul>
    <div class="clear"></div>
</fieldset>
 
<div class="clear"></div>

<script src="~/scripts/jquery-1.6.4.js" type="text/javascript"></script>
<script src="~/scripts/jquery.signalR-2.0.0-beta2.js" type="text/javascript"></script>
<script src="~/signalr/hubs"></script>
<script type="text/javascript">

    var router = $.connection.routingHub;


    router.client.wipMovedToAssemble = function (data) {
        alert('wip moved to assemble: ' + data.WipId);
    };

    $(function () {
        




        releaseWipTimer();

        $("#move").click(function() {
            moveTo("#assemble", 1);
        });
    });

    var _id = 1;
    var wipReleaseTimer = 1;
    function releaseWipTimer() {
        $('#timer').html(wipReleaseTimer);
        
        if (wipReleaseTimer == 0) {
            releaseWip();
            wipReleaseTimer = 5;
        } else {
            wipReleaseTimer--;
        }
        
        setTimeout('releaseWipTimer()', 1000);
    }
    
    function releaseWip() {
        wipReleased();
    }
    
    function wipReleased() {
        var li = $("<li>TEST" + _id + "</li>");
        li.attr("id", _id++);
        $('#wip ul').append(li);
    }
    
    function moveTo(container, id) {
        var li = $("ul li#" + id);
        li.remove();
        $('ul', container).append(li);
    }
</script>